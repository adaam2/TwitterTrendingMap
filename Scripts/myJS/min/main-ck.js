var map,mc,clusters=[{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50}];$(function(){function e(){var e=[{featureType:"water",stylers:[{saturation:43},{lightness:-11},{hue:"#0088ff"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:"#ff0000"},{saturation:-100},{lightness:99}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#808080"},{lightness:54}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ece2d9"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#ccdca1"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#767676"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#b8cb93"}]},{featureType:"poi.park",stylers:[{visibility:"on"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"on"}]},{featureType:"poi.medical",stylers:[{visibility:"on"}]},{featureType:"poi.business",stylers:[{visibility:"simplified"}]}],t={zoom:5,backgroundColor:"#A3A3A3",disableDoubleClickZoom:!0,center:new google.maps.LatLng(53,-.2),mapTypeID:google.maps.MapTypeId.HYBRID,keyboardShortcuts:!1,overviewMapControl:!1,panControl:!1,scrollwheel:!1,streetViewControl:!1,styles:e};a=new google.maps.Map(document.getElementById("map-canvas"),t);var o={gridSize:100,batchSize:3e3,batchSizeIE:200,maxZoom:12,averageCenter:!1};mc=new MarkerClusterer(a,[],o)}function t(e){var t=new Date(e.CreatedAt),o=t.getDate(),a=t.getMonth()+1,s=t.getFullYear(),l=t.toTimeString(),i=o+"/"+a+"/"+s,r='<div class="tweet">        <div class="header">        <div class="avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></div>        <div class="screen-name"><span class="handle">@'+e.User+'</span><span class="time-ago"><time class="timeago" datetime="'+e.CreatedAt+'">'+e.CreatedAt+'</time></span></div>        </div>        <div class="body"><p>'+e.Text+'</p></div>        <div class="footer">'+i+" "+l+"</div>        </div>";return r}$("#minimize").click(function(){var e=$(".toggle");e.slideToggle(),$(this).text(function(e,t){return"More"===t?"Less":"More"})}),e(),$("#autocomplete").geocomplete().bind("geocode:result",function(e,t){a.setCenter(t.geometry.location),a.setZoom(13)});var o=$.connection.geoFeedHub,a;o.client.broadcastTweetMessage=function(e){var o=new google.maps.Marker({map:a,position:new google.maps.LatLng(e.Latitude,e.Longitude),title:e.Text+" by @"+e.User}),s=new google.maps.InfoWindow({content:t(e)});$("time.timeago").timeago(),google.maps.event.addListener(o,"click",function(){a.panTo(o.getPosition()),s.open(a,o)}),mc.addMarker(o);var l=$("ul.live-tweets li").size(),i=10,r='<li class="tweet-item"><span class="tweet-content">'+e.Text+'</span><span class="tweet-author">'+e.User+"</span></li>";i>l?$("ul.live-tweets").prepend(r):($("ul.live-tweets li:last-child").remove(),$("ul.live-tweets").prepend(r))},o.client.broadcastStatus=function(e){console.log(e.Message+"<br/>"+e.StackTrace)},$.connection.hub.start().done(function(){$("#signalr-status").text("Now connected (connection ID "+$.connection.hub.id+")")})});