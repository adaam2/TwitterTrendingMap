var map,mc,clusters=[{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50}];$(function(){function e(){var e=[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"off"}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"off"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"off"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#8899a6"},{lightness:-25},{saturation:-100}]}],t={zoom:5,backgroundColor:"#A3A3A3",disableDoubleClickZoom:!0,center:new google.maps.LatLng(53,-.2),mapTypeID:google.maps.MapTypeId.HYBRID,keyboardShortcuts:!1,overviewMapControl:!1,panControl:!1,scrollwheel:!1,streetViewControl:!1,styles:e};a=new google.maps.Map(document.getElementById("map-canvas"),t);var i={gridSize:100,batchSize:3e3,batchSizeIE:200,maxZoom:12,averageCenter:!1};mc=new MarkerClusterer(a,[],i)}function t(e){var t=new Date(e.CreatedAt),i=t.getDate(),a=t.getMonth()+1,o=t.getFullYear(),s=t.toTimeString(),l=i+"/"+a+"/"+o,n='<div class="tweet">        <div class="header">        <div class="avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></div>        <div class="screen-name"><span class="handle">@'+e.User+'</span><span class="time-ago"><time class="timeago" datetime="'+e.CreatedAt+'">(you shouldnt see this)</time></span></div>        </div>        <div class="body"><p>'+e.Text+'</p></div>        <div class="footer">'+l+" "+s+"</div>        </div>";return n}$("#minimize").click(function(){var e=$(".toggle");e.slideToggle(),$(this).text(function(e,t){return"More"===t?"Less":"More"})}),e(),$("#autocomplete").geocomplete().bind("geocode:result",function(e,t){a.setCenter(t.geometry.location),a.setZoom(13)});var i=$.connection.geoFeedHub,a;i.client.broadcastTweetMessage=function(e){var i=new google.maps.Marker({map:a,position:new google.maps.LatLng(e.Latitude,e.Longitude),title:e.Text+" by @"+e.User}),o=new google.maps.InfoWindow({content:t(e)});$("time.timeago").timeago(),google.maps.event.addListener(i,"click",function(){a.panTo(i.getPosition()),o.open(a,i)}),mc.addMarker(i);var s=$("ul.live-tweets li").size();10>s?$("ul.live-tweets").prepend("<li>"+e.Text+"</li>"):($("ul.live-tweets li:last-child").remove(),$("ul.live-tweets").prepend("<li>"+e.Text+"</li>")),console.log(s)},i.client.broadcastStatus=function(e){console.log(e.Message+"<br/>"+e.StackTrace)},$.connection.hub.start().done(function(){console.log("Now connected with connection ID = "+$.connection.hub.id)})});