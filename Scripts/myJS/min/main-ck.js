var map,mc,clusters=[{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50},{textColor:"white",url:"path/to/smallclusterimage.png",height:50,width:50}];$(function(){function e(){var e=[{featureType:"water",stylers:[{saturation:43},{lightness:-11},{hue:"#0088ff"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:"#ff0000"},{saturation:-100},{lightness:99}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#808080"},{lightness:54}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ece2d9"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#ccdca1"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#767676"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#b8cb93"}]},{featureType:"poi.park",stylers:[{visibility:"on"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"on"}]},{featureType:"poi.medical",stylers:[{visibility:"on"}]},{featureType:"poi.business",stylers:[{visibility:"simplified"}]}],t={zoom:5,backgroundColor:"#A3A3A3",disableDoubleClickZoom:!0,center:new google.maps.LatLng(53,-.2),mapTypeID:google.maps.MapTypeId.HYBRID,keyboardShortcuts:!1,overviewMapControl:!1,panControl:!1,scrollwheel:!1,streetViewControl:!1,styles:e};o=new google.maps.Map(document.getElementById("map-canvas"),t);var a={gridSize:100,batchSize:3e3,batchSizeIE:200,maxZoom:12,averageCenter:!1};mc=new MarkerClusterer(o,[],a)}function t(e){var t=new Date(e.CreatedAt),a=t.getDate(),o=t.getMonth()+1,s=t.getFullYear(),i=t.toTimeString(),l=a+"/"+o+"/"+s,r='<div class="tweet">        <div class="header">        <div class="avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></div>        <div class="screen-name"><span class="handle">@'+e.User+'</span><span class="time-ago"><time class="timeago" datetime="'+e.CreatedAt+'">'+e.CreatedAt+'</time></span></div>        </div>        <div class="body"><p>'+e.Text+'</p></div>        <div class="footer">'+l+" "+i+"</div>        </div>";return r}$("#minimize").click(function(){var e=$(".toggle");e.slideToggle(),$(this).text(function(e,t){return"More"===t?"Less":"More"})}),e(),$("#autocomplete").geocomplete().bind("geocode:result",function(e,t){o.setCenter(t.geometry.location),o.setZoom(13)});var a=$.connection.geoFeedHub,o;a.client.broadcastTweetMessage=function(e){var a=new google.maps.Marker({map:o,position:new google.maps.LatLng(e.Latitude,e.Longitude),title:e.Text+" by @"+e.User}),s=new google.maps.InfoWindow({content:t(e)});$("time.timeago").timeago(),google.maps.event.addListener(a,"click",function(){o.panTo(a.getPosition()),s.open(o,a)}),mc.addMarker(a);var i=$("ul.live-tweets li").size(),l=10,r='<li class="tweet-item"><span class="tweet-avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></span><span class="tweet-content">'+e.Text+'</span><span class="tweet-author">'+e.User+"</span></li>";l>i?$("ul.live-tweets").prepend(r):($("ul.live-tweets li:last-child").remove(),$("ul.live-tweets").prepend(r))},a.client.twitterConnectionSuccess=function(e){$("#twitterapi-status").text(e)},a.client.broadcastStatus=function(e){console.log(e),console.log(e.Message+"<br/>"+e.StackTrace+"<br/>"+e.TwitterCode+"<br/>"+e.TwitterReason)},$.connection.hub.start().done(function(){$("#signalr-status").text("Now connected (connection ID "+$.connection.hub.id+")")})});