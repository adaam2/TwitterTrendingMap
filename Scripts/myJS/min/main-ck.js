var map,mc;$(function(){function e(){var e=[{featureType:"water",stylers:[{saturation:43},{lightness:-11},{hue:"#0088ff"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:"#ff0000"},{saturation:-100},{lightness:99}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#808080"},{lightness:54}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ece2d9"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#ccdca1"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#767676"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#b8cb93"}]},{featureType:"poi.park",stylers:[{visibility:"on"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"on"}]},{featureType:"poi.medical",stylers:[{visibility:"on"}]},{featureType:"poi.business",stylers:[{visibility:"simplified"}]}],t={zoom:5,backgroundColor:"#A3A3A3",disableDoubleClickZoom:!0,center:new google.maps.LatLng(53,-.2),mapTypeID:google.maps.MapTypeId.HYBRID,keyboardShortcuts:!1,overviewMapControl:!1,panControl:!1,scrollwheel:!1,streetViewControl:!1,styles:e};s=new google.maps.Map(document.getElementById("map-canvas"),t),s.set("streetViewControl",!0);var a={gridSize:100,batchSize:3e3,batchSizeIE:200,maxZoom:12,averageCenter:!1};mc=new MarkerClusterer(s,[],a)}function t(e){var t=new Date(e.CreatedAt),a=t.getDate(),s=t.getMonth()+1,o=t.getFullYear(),i=t.toTimeString(),r=a+"/"+s+"/"+o,l='<div class="tweet">        <div class="header">        <div class="avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></div>        <div class="screen-name"><span class="handle">@'+e.User+'</span><span class="time-ago"><time class="timeago" datetime="'+e.CreatedAt+'">'+r+'</time></span></div>        </div>        <div class="body"><p>'+e.Text+'</p></div>        <div class="footer">'+r+" "+i+"</div>        </div>";return l}$("#minimize").click(function(){var e=$(".toggle");e.slideToggle(),$(this).text(function(e,t){return"More"===t?"Less":"More"})}),e(),$("#autocomplete").geocomplete().bind("geocode:result",function(e,t){s.setCenter(t.geometry.location),s.setZoom(13)});var a=$.connection.geoFeedHub,s;a.client.broadcastTweetMessage=function(e){var a=new google.maps.Marker({map:s,position:new google.maps.LatLng(e.Latitude,e.Longitude),title:e.Text+" by @"+e.User}),o=new google.maps.InfoWindow({content:t(e)});$("time.timeago").timeago(),google.maps.event.addListener(a,"click",function(){s.panTo(a.getPosition()),o.open(s,a)}),mc.addMarker(a);var i=$("ul.live-tweets li").size(),r=10,l='<li class="tweet-item"><span class="tweet-avatar"><a target="_blank" href="https://www.twitter.com/'+e.User+'"><img src="'+e.ImageUrl+'"/></a></span><span class="tweet-content">'+e.Text+'</span><span class="tweet-author">@'+e.User+"</span></li>";r>i?$("ul.live-tweets").prepend(l):($("ul.live-tweets li:last-child").remove(),$("ul.live-tweets").prepend(l))},a.client.twitterConnectionSuccess=function(e){$("#twitterapi-status").text(e)},a.client.broadcastStatus=function(e){console.log(e.Message+"<br/>"+e.StackTrace+"<br/>"+e.TwitterCode+"<br/>"+e.TwitterReason)},$.connection.hub.start().done(function(){$("#signalr-status").html('Connected <i class="fa fa-check-circle"></i>')});var o=$.connection.trendsAnalysisHub;o.client.broadcastTrend=function(e){$.each(e,function(t){console.log(e[t])})}});